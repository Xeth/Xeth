(function($){"use strict";var EditableForm=function(div,options){this.options=$.extend({},$.fn.editableform.defaults,options);this.$div=$(div);if(!this.options.scope){this.options.scope=this}};EditableForm.prototype={constructor:EditableForm,initInput:function(){this.input=this.options.input;this.value=this.input.str2value(this.options.value);this.input.prerender()},initTemplate:function(){this.$form=$($.fn.editableform.template)},initButtons:function(){var $btn=this.$form.find(".editable-buttons");$btn.append($.fn.editableform.buttons);if(this.options.showbuttons==="bottom"){$btn.addClass("editable-buttons-bottom")}},render:function(){this.$loading=$($.fn.editableform.loading);this.$div.empty().append(this.$loading);this.initTemplate();if(this.options.showbuttons){this.initButtons()}else{this.$form.find(".editable-buttons").remove()}this.showLoading();this.isSaving=false;this.$div.triggerHandler("rendering");this.initInput();this.$form.find("div.editable-input").append(this.input.$tpl);this.$div.append(this.$form);$.when(this.input.render()).then($.proxy(function(){if(!this.options.showbuttons){this.input.autosubmit()}this.$form.find(".editable-cancel").click($.proxy(this.cancel,this));if(this.input.error){this.error(this.input.error);this.$form.find(".editable-submit").attr("disabled",true);this.input.$input.attr("disabled",true);this.$form.submit(function(e){e.preventDefault()})}else{this.error(false);this.input.$input.removeAttr("disabled");this.$form.find(".editable-submit").removeAttr("disabled");var value=this.value===null||this.value===undefined||this.value===""?this.options.defaultValue:this.value;this.input.value2input(value);this.$form.submit($.proxy(this.submit,this))}this.$div.triggerHandler("rendered");this.showForm();if(this.input.postrender){this.input.postrender()}},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var w,h;if(this.$form){w=this.$form.outerWidth();h=this.$form.outerHeight();if(w){this.$loading.width(w)}if(h){this.$loading.height(h)}this.$form.hide()}else{w=this.$loading.parent().width();if(w){this.$loading.width(w)}}this.$loading.show()},showForm:function(activate){this.$loading.hide();this.$form.show();if(activate!==false){this.input.activate()}this.$div.triggerHandler("show")},error:function(msg){var $group=this.$form.find(".control-group"),$block=this.$form.find(".editable-error-block"),lines;if(msg===false){$group.removeClass($.fn.editableform.errorGroupClass);$block.removeClass($.fn.editableform.errorBlockClass).empty().hide()}else{if(msg){lines=(""+msg).split("\n");for(var i=0;i<lines.length;i++){lines[i]=$("<div>").text(lines[i]).html()}msg=lines.join("<br>")}$group.addClass($.fn.editableform.errorGroupClass);$block.addClass($.fn.editableform.errorBlockClass).html(msg).show()}},submit:function(e){e.stopPropagation();e.preventDefault();var newValue=this.input.input2value();var error=this.validate(newValue);if($.type(error)==="object"&&error.newValue!==undefined){newValue=error.newValue;this.input.value2input(newValue);if(typeof error.msg==="string"){this.error(error.msg);this.showForm();return}}else if(error){this.error(error);this.showForm();return}if(!this.options.savenochange&&this.input.value2str(newValue)==this.input.value2str(this.value)){this.$div.triggerHandler("nochange");return}var submitValue=this.input.value2submit(newValue);this.isSaving=true;$.when(this.save(submitValue)).done($.proxy(function(response){this.isSaving=false;var res=typeof this.options.success==="function"?this.options.success.call(this.options.scope,response,newValue):null;if(res===false){this.error(false);this.showForm(false);return}if(typeof res==="string"){this.error(res);this.showForm();return}if(res&&typeof res==="object"&&res.hasOwnProperty("newValue")){newValue=res.newValue}this.error(false);this.value=newValue;this.$div.triggerHandler("save",{newValue:newValue,submitValue:submitValue,response:response})},this)).fail($.proxy(function(xhr){this.isSaving=false;var msg;if(typeof this.options.error==="function"){msg=this.options.error.call(this.options.scope,xhr,newValue)}else{msg=typeof xhr==="string"?xhr:xhr.responseText||xhr.statusText||"Unknown error!"}this.error(msg);this.showForm()},this))},save:function(submitValue){this.options.pk=$.fn.editableutils.tryParseJson(this.options.pk,true);var pk=typeof this.options.pk==="function"?this.options.pk.call(this.options.scope):this.options.pk,send=!!(typeof this.options.url==="function"||this.options.url&&(this.options.send==="always"||this.options.send==="auto"&&pk!==null&&pk!==undefined)),params;if(send){this.showLoading();params={name:this.options.name||"",value:submitValue,pk:pk};if(typeof this.options.params==="function"){params=this.options.params.call(this.options.scope,params)}else{this.options.params=$.fn.editableutils.tryParseJson(this.options.params,true);$.extend(params,this.options.params)}if(typeof this.options.url==="function"){return this.options.url.call(this.options.scope,params)}else{return $.ajax($.extend({url:this.options.url,data:params,type:"POST"},this.options.ajaxOptions))}}},validate:function(value){if(value===undefined){value=this.value}if(typeof this.options.validate==="function"){return this.options.validate.call(this.options.scope,value)}},option:function(key,value){if(key in this.options){this.options[key]=value}if(key==="value"){this.setValue(value)}},setValue:function(value,convertStr){if(convertStr){this.value=this.input.str2value(value)}else{this.value=value}if(this.$form&&this.$form.is(":visible")){this.input.value2input(this.value)}}};$.fn.editableform=function(option){var args=arguments;return this.each(function(){var $this=$(this),data=$this.data("editableform"),options=typeof option==="object"&&option;if(!data){$this.data("editableform",data=new EditableForm(this,options))}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1))}})};$.fn.editableform.Constructor=EditableForm;$.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:true,scope:null,savenochange:false};$.fn.editableform.template='<form class="form-inline editableform">'+'<div class="control-group">'+'<div><div class="editable-input"></div><div class="editable-buttons"></div></div>'+'<div class="editable-error-block"></div>'+"</div>"+"</form>";$.fn.editableform.loading='<div class="editableform-loading"></div>';$.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button>'+'<button type="button" class="editable-cancel">cancel</button>';$.fn.editableform.errorGroupClass=null;$.fn.editableform.errorBlockClass="editable-error";$.fn.editableform.engine="jquery"})(window.jQuery);(function($){"use strict";$.fn.editableutils={inherit:function(Child,Parent){var F=function(){};F.prototype=Parent.prototype;Child.prototype=new F;Child.prototype.constructor=Child;Child.superclass=Parent.prototype},setCursorPosition:function(elem,pos){if(elem.setSelectionRange){elem.setSelectionRange(pos,pos)}else if(elem.createTextRange){var range=elem.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}},tryParseJson:function(s,safe){if(typeof s==="string"&&s.length&&s.match(/^[\{\[].*[\}\]]$/)){if(safe){try{s=new Function("return "+s)()}catch(e){}finally{return s}}else{s=new Function("return "+s)()}}return s},sliceObj:function(obj,keys,caseSensitive){var key,keyLower,newObj={};if(!$.isArray(keys)||!keys.length){return newObj}for(var i=0;i<keys.length;i++){key=keys[i];if(obj.hasOwnProperty(key)){newObj[key]=obj[key]}if(caseSensitive===true){continue}keyLower=key.toLowerCase();if(obj.hasOwnProperty(keyLower)){newObj[key]=obj[keyLower]}}return newObj},getConfigData:function($element){var data={};$.each($element.data(),function(k,v){if(typeof v!=="object"||v&&typeof v==="object"&&(v.constructor===Object||v.constructor===Array)){data[k]=v}});return data},objectKeys:function(o){if(Object.keys){return Object.keys(o)}else{if(o!==Object(o)){throw new TypeError("Object.keys called on a non-object")}var k=[],p;for(p in o){if(Object.prototype.hasOwnProperty.call(o,p)){k.push(p)}}return k}},escape:function(str){return $("<div>").text(str).html()},itemsByValue:function(value,sourceData,valueProp){if(!sourceData||value===null){return[]}if(typeof valueProp!=="function"){var idKey=valueProp||"value";valueProp=function(e){return e[idKey]}}var isValArray=$.isArray(value),result=[],that=this;$.each(sourceData,function(i,o){if(o.children){result=result.concat(that.itemsByValue(value,o.children,valueProp))}else{if(isValArray){if($.grep(value,function(v){return v==(o&&typeof o==="object"?valueProp(o):o)}).length){result.push(o)}}else{var itemValue=o&&typeof o==="object"?valueProp(o):o;if(value==itemValue){result.push(o)}}}});return result},createInput:function(options){var TypeConstructor,typeOptions,input,type=options.type;if(type==="date"){if(options.mode==="inline"){if($.fn.editabletypes.datefield){type="datefield"}else if($.fn.editabletypes.dateuifield){type="dateuifield"}}else{if($.fn.editabletypes.date){type="date"}else if($.fn.editabletypes.dateui){type="dateui"}}if(type==="date"&&!$.fn.editabletypes.date){type="combodate"}}if(type==="datetime"&&options.mode==="inline"){type="datetimefield"}if(type==="wysihtml5"&&!$.fn.editabletypes[type]){type="textarea"}if(typeof $.fn.editabletypes[type]==="function"){TypeConstructor=$.fn.editabletypes[type];typeOptions=this.sliceObj(options,this.objectKeys(TypeConstructor.defaults));input=new TypeConstructor(typeOptions);return input}else{$.error("Unknown type: "+type);return false}},supportsTransitions:function(){var b=document.body||document.documentElement,s=b.style,p="transition",v=["Moz","Webkit","Khtml","O","ms"];if(typeof s[p]==="string"){return true}p=p.charAt(0).toUpperCase()+p.substr(1);for(var i=0;i<v.length;i++){if(typeof s[v[i]+p]==="string"){return true}}return false}}})(window.jQuery);(function($){"use strict";var Popup=function(element,options){this.init(element,options)};var Inline=function(element,options){this.init(element,options)};Popup.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.editableContainer.defaults,options);this.splitOptions();this.formOptions.scope=this.$element[0];this.initContainer();this.delayedHide=false;this.$element.on("destroyed",$.proxy(function(){this.destroy()},this));if(!$(document).data("editable-handlers-attached")){$(document).on("keyup.editable",function(e){if(e.which===27){$(".editable-open").editableContainer("hide")}});$(document).on("click.editable",function(e){var $target=$(e.target),i,exclude_classes=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!$.contains(document.documentElement,e.target)){return}if($target.is(document)){return}for(i=0;i<exclude_classes.length;i++){if($target.is(exclude_classes[i])||$target.parents(exclude_classes[i]).length){return}}Popup.prototype.closeOthers(e.target)});$(document).data("editable-handlers-attached",true)}},splitOptions:function(){this.containerOptions={};this.formOptions={};if(!$.fn[this.containerName]){throw new Error(this.containerName+" not found. Have you included corresponding js file?")}for(var k in this.options){if(k in this.defaults){this.containerOptions[k]=this.options[k]}else{this.formOptions[k]=this.options[k]}}},tip:function(){return this.container()?this.container().$tip:null},container:function(){var container;if(this.containerDataName){if(container=this.$element.data(this.containerDataName)){return container}}container=this.$element.data(this.containerName);return container},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:$.proxy(this.save,this),nochange:$.proxy(function(){this.hide("nochange")},this),cancel:$.proxy(function(){this.hide("cancel")},this),show:$.proxy(function(){if(this.delayedHide){this.hide(this.delayedHide.reason);this.delayedHide=false}else{this.setPosition()}},this),rendering:$.proxy(this.setPosition,this),resize:$.proxy(this.setPosition,this),rendered:$.proxy(function(){this.$element.triggerHandler("shown",$(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(closeAll){this.$element.addClass("editable-open");if(closeAll!==false){this.closeOthers(this.$element[0])}this.innerShow();this.tip().addClass(this.containerClass);if(this.$form){}this.$form=$("<div>");if(this.tip().is(this.innerCss)){this.tip().append(this.$form)}else{this.tip().find(this.innerCss).append(this.$form)}this.renderForm()},hide:function(reason){if(!this.tip()||!this.tip().is(":visible")||!this.$element.hasClass("editable-open")){return}if(this.$form.data("editableform").isSaving){this.delayedHide={reason:reason};return}else{this.delayedHide=false}this.$element.removeClass("editable-open");this.innerHide();this.$element.triggerHandler("hidden",reason||"manual")},innerShow:function(){},innerHide:function(){},toggle:function(closeAll){if(this.container()&&this.tip()&&this.tip().is(":visible")){this.hide()}else{this.show(closeAll)}},setPosition:function(){},save:function(e,params){this.$element.triggerHandler("save",params);this.hide("save")},option:function(key,value){this.options[key]=value;if(key in this.containerOptions){this.containerOptions[key]=value;this.setContainerOption(key,value)}else{this.formOptions[key]=value;if(this.$form){this.$form.editableform("option",key,value)}}},setContainerOption:function(key,value){this.call("option",key,value)},destroy:function(){this.hide();this.innerDestroy();this.$element.off("destroyed");this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(element){$(".editable-open").each(function(i,el){if(el===element||$(el).find(element).length){return}var $el=$(el),ec=$el.data("editableContainer");if(!ec){return}if(ec.options.onblur==="cancel"){$el.data("editableContainer").hide("onblur")}else if(ec.options.onblur==="submit"){$el.data("editableContainer").tip().find("form").submit()}})},activate:function(){if(this.tip&&this.tip().is(":visible")&&this.$form){this.$form.data("editableform").input.activate()}}};$.fn.editableContainer=function(option){var args=arguments;return this.each(function(){var $this=$(this),dataKey="editableContainer",data=$this.data(dataKey),options=typeof option==="object"&&option,Constructor=options.mode==="inline"?Inline:Popup;if(!data){$this.data(dataKey,data=new Constructor(this,options))}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1))}})};$.fn.editableContainer.Popup=Popup;$.fn.editableContainer.Inline=Inline;$.fn.editableContainer.defaults={value:null,placement:"top",autohide:true,onblur:"cancel",anim:false,mode:"popup"};jQuery.event.special.destroyed={remove:function(o){if(o.handler){o.handler()}}}})(window.jQuery);(function($){"use strict";$.extend($.fn.editableContainer.Inline.prototype,$.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=$("<span></span>");if(!this.options.anim){this.options.anim=0}},splitOptions:function(){this.containerOptions={};this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide();this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,$.proxy(function(){this.$element.show();this.innerDestroy()},this))},innerDestroy:function(){if(this.tip()){this.tip().empty().remove()}}})})(window.jQuery);(function($){"use strict";var Editable=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.editable.defaults,options,$.fn.editableutils.getConfigData(this.$element));if(this.options.selector){this.initLive()}else{this.init()}if(this.options.highlight&&!$.fn.editableutils.supportsTransitions()){this.options.highlight=false}};Editable.prototype={constructor:Editable,init:function(){var isValueByText=false,doAutotext,finalize;this.options.name=this.options.name||this.$element.attr("id");this.options.scope=this.$element[0];this.input=$.fn.editableutils.createInput(this.options);if(!this.input){return}if(this.options.value===undefined||this.options.value===null){this.value=this.input.html2value($.trim(this.$element.html()));isValueByText=true}else{this.options.value=$.fn.editableutils.tryParseJson(this.options.value,true);if(typeof this.options.value==="string"){this.value=this.input.str2value(this.options.value)}else{this.value=this.options.value}}this.$element.addClass("editable");if(this.input.type==="textarea"){this.$element.addClass("editable-pre-wrapped")}if(this.options.toggle!=="manual"){this.$element.addClass("editable-click");this.$element.on(this.options.toggle+".editable",$.proxy(function(e){if(!this.options.disabled){e.preventDefault()}if(this.options.toggle==="mouseenter"){this.show()}else{var closeAll=this.options.toggle!=="click";this.toggle(closeAll)}},this))}else{this.$element.attr("tabindex",-1)}if(typeof this.options.display==="function"){this.options.autotext="always"}switch(this.options.autotext){case"always":doAutotext=true;break;case"auto":doAutotext=!$.trim(this.$element.text()).length&&this.value!==null&&this.value!==undefined&&!isValueByText;break;default:doAutotext=false}$.when(doAutotext?this.render():true).then($.proxy(function(){if(this.options.disabled){this.disable()}else{this.enable()}this.$element.triggerHandler("init",this)},this))},initLive:function(){var selector=this.options.selector;this.options.selector=false;this.options.autotext="never";this.$element.on(this.options.toggle+".editable",selector,$.proxy(function(e){var $target=$(e.target);if(!$target.data("editable")){if($target.hasClass(this.options.emptyclass)){$target.empty()}$target.editable(this.options).trigger(e)}},this))},render:function(response){if(this.options.display===false){return}if(this.input.value2htmlFinal){return this.input.value2html(this.value,this.$element[0],this.options.display,response)}else if(typeof this.options.display==="function"){return this.options.display.call(this.$element[0],this.value,response)}else{return this.input.value2html(this.value,this.$element[0])}},enable:function(){this.options.disabled=false;this.$element.removeClass("editable-disabled");this.handleEmpty(this.isEmpty);if(this.options.toggle!=="manual"){if(this.$element.attr("tabindex")==="-1"){this.$element.removeAttr("tabindex")}}},disable:function(){this.options.disabled=true;this.hide();this.$element.addClass("editable-disabled");this.handleEmpty(this.isEmpty);this.$element.attr("tabindex",-1)},toggleDisabled:function(){if(this.options.disabled){this.enable()}else{this.disable()}},option:function(key,value){if(key&&typeof key==="object"){$.each(key,$.proxy(function(k,v){this.option($.trim(k),v)},this));return}this.options[key]=value;if(key==="disabled"){return value?this.disable():this.enable()}if(key==="value"){this.setValue(value)}if(this.container){this.container.option(key,value)}if(this.input.option){this.input.option(key,value)}},handleEmpty:function(isEmpty){if(this.options.display===false){return}if(isEmpty!==undefined){this.isEmpty=isEmpty}else{if(typeof this.input.isEmpty==="function"){this.isEmpty=this.input.isEmpty(this.$element)}else{this.isEmpty=$.trim(this.$element.html())===""}}if(!this.options.disabled){if(this.isEmpty){this.$element.html(this.options.emptytext);if(this.options.emptyclass){this.$element.addClass(this.options.emptyclass)}}else if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass)}}else{if(this.isEmpty){this.$element.empty();if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass)}}}},show:function(closeAll){if(this.options.disabled){return}if(!this.container){var containerOptions=$.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(containerOptions);this.$element.on("save.internal",$.proxy(this.save,this));this.container=this.$element.data("editableContainer")}else if(this.container.tip().is(":visible")){return}this.container.show(closeAll)},hide:function(){if(this.container){this.container.hide()}},toggle:function(closeAll){if(this.container&&this.container.tip().is(":visible")){this.hide()}else{this.show(closeAll)}},save:function(e,params){if(this.options.unsavedclass){var sent=false;sent=sent||typeof this.options.url==="function";sent=sent||this.options.display===false;sent=sent||params.response!==undefined;sent=sent||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(params.newValue);if(sent){this.$element.removeClass(this.options.unsavedclass)}else{this.$element.addClass(this.options.unsavedclass)}}if(this.options.highlight){var $e=this.$element,bgColor=$e.css("background-color");$e.css("background-color",this.options.highlight);setTimeout(function(){if(bgColor==="transparent"){bgColor=""}$e.css("background-color",bgColor);$e.addClass("editable-bg-transition");setTimeout(function(){$e.removeClass("editable-bg-transition")},1700)},10)}this.setValue(params.newValue,false,params.response)},validate:function(){if(typeof this.options.validate==="function"){return this.options.validate.call(this,this.value)}},setValue:function(value,convertStr,response){if(convertStr){this.value=this.input.str2value(value)}else{this.value=value}if(this.container){this.container.option("value",this.value)}$.when(this.render(response)).then($.proxy(function(){this.handleEmpty()},this))},activate:function(){if(this.container){this.container.activate()}},destroy:function(){this.disable();if(this.container){this.container.destroy()}this.input.destroy();if(this.options.toggle!=="manual"){this.$element.removeClass("editable-click");this.$element.off(this.options.toggle+".editable")}this.$element.off("save.internal");this.$element.removeClass("editable editable-open editable-disabled");this.$element.removeData("editable")}};$.fn.editable=function(option){var result={},args=arguments,datakey="editable";switch(option){case"validate":this.each(function(){var $this=$(this),data=$this.data(datakey),error;if(data&&(error=data.validate())){result[data.options.name]=error}});return result;case"getValue":if(arguments.length===2&&arguments[1]===true){result=this.eq(0).data(datakey).value}else{this.each(function(){var $this=$(this),data=$this.data(datakey);if(data&&data.value!==undefined&&data.value!==null){result[data.options.name]=data.input.value2submit(data.value)}})}return result;case"submit":var config=arguments[1]||{},$elems=this,errors=this.editable("validate");if($.isEmptyObject(errors)){var ajaxOptions={};if($elems.length===1){var editable=$elems.data("editable");var params={name:editable.options.name||"",value:editable.input.value2submit(editable.value),pk:typeof editable.options.pk==="function"?editable.options.pk.call(editable.options.scope):editable.options.pk};if(typeof editable.options.params==="function"){params=editable.options.params.call(editable.options.scope,params)}else{editable.options.params=$.fn.editableutils.tryParseJson(editable.options.params,true);$.extend(params,editable.options.params)}ajaxOptions={url:editable.options.url,data:params,type:"POST"};config.success=config.success||editable.options.success;config.error=config.error||editable.options.error}else{var values=this.editable("getValue");ajaxOptions={url:config.url,data:values,type:"POST"}}ajaxOptions.success=typeof config.success==="function"?function(response){config.success.call($elems,response,config)}:$.noop;ajaxOptions.error=typeof config.error==="function"?function(){config.error.apply($elems,arguments)}:$.noop;if(config.ajaxOptions){$.extend(ajaxOptions,config.ajaxOptions)}if(config.data){$.extend(ajaxOptions.data,config.data)}$.ajax(ajaxOptions)}else{if(typeof config.error==="function"){config.error.call($elems,errors)}}return this}return this.each(function(){var $this=$(this),data=$this.data(datakey),options=typeof option==="object"&&option;if(options&&options.selector){data=new Editable(this,options);return}if(!data){$this.data(datakey,data=new Editable(this,options))}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1))}})};$.fn.editable.defaults={type:"text",disabled:false,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}})(window.jQuery);(function($){"use strict";$.fn.editabletypes={};var AbstractInput=function(){};AbstractInput.prototype={init:function(type,options,defaults){this.type=type;this.options=$.extend({},defaults,options)},prerender:function(){this.$tpl=$(this.options.tpl);this.$input=this.$tpl;this.$clear=null;this.error=null},render:function(){},value2html:function(value,element){$(element)[this.options.escape?"text":"html"]($.trim(value))},html2value:function(html){return $("<div>").html(html).text()},value2str:function(value){return value},str2value:function(str){return str},value2submit:function(value){return value},value2input:function(value){this.$input.val(value)},input2value:function(){return this.$input.val()},activate:function(){if(this.$input.is(":visible")){this.$input.focus()}},clear:function(){this.$input.val(null)},escape:function(str){return $("<div>").text(str).html()},autosubmit:function(){},destroy:function(){},setClass:function(){if(this.options.inputclass){this.$input.addClass(this.options.inputclass)}},setAttr:function(attr){if(this.options[attr]!==undefined&&this.options[attr]!==null){this.$input.attr(attr,this.options[attr])}},option:function(key,value){this.options[key]=value}};AbstractInput.defaults={tpl:"",inputclass:null,escape:true,scope:null,showbuttons:true};$.extend($.fn.editabletypes,{abstractinput:AbstractInput})})(window.jQuery);(function($){"use strict";var List=function(options){};$.fn.editableutils.inherit(List,$.fn.editabletypes.abstractinput);$.extend(List.prototype,{render:function(){var deferred=$.Deferred();this.error=null;this.onSourceReady(function(){this.renderList();deferred.resolve()},function(){this.error=this.options.sourceError;deferred.resolve()});return deferred.promise()},html2value:function(html){return null},value2html:function(value,element,display,response){var deferred=$.Deferred(),success=function(){if(typeof display==="function"){display.call(element,value,this.sourceData,response)}else{this.value2htmlFinal(value,element)}deferred.resolve()};if(value===null){success.call(this)}else{this.onSourceReady(success,function(){deferred.resolve()})}return deferred.promise()},onSourceReady:function(success,error){var source;if($.isFunction(this.options.source)){source=this.options.source.call(this.options.scope);this.sourceData=null}else{source=this.options.source}if(this.options.sourceCache&&$.isArray(this.sourceData)){success.call(this);return}try{source=$.fn.editableutils.tryParseJson(source,false)}catch(e){error.call(this);return}if(typeof source==="string"){if(this.options.sourceCache){var cacheID=source,cache;if(!$(document).data(cacheID)){$(document).data(cacheID,{})}cache=$(document).data(cacheID);if(cache.loading===false&&cache.sourceData){this.sourceData=cache.sourceData;this.doPrepend();success.call(this);return}else if(cache.loading===true){cache.callbacks.push($.proxy(function(){this.sourceData=cache.sourceData;this.doPrepend();success.call(this)},this));cache.err_callbacks.push($.proxy(error,this));return}else{cache.loading=true;cache.callbacks=[];cache.err_callbacks=[]}}var ajaxOptions=$.extend({url:source,type:"get",cache:false,dataType:"json",success:$.proxy(function(data){if(cache){cache.loading=false}this.sourceData=this.makeArray(data);if($.isArray(this.sourceData)){if(cache){cache.sourceData=this.sourceData;$.each(cache.callbacks,function(){this.call()})}this.doPrepend();success.call(this)}else{error.call(this);if(cache){$.each(cache.err_callbacks,function(){this.call()})}}},this),error:$.proxy(function(){error.call(this);if(cache){cache.loading=false;$.each(cache.err_callbacks,function(){this.call()})}},this)},this.options.sourceOptions);$.ajax(ajaxOptions)}else{this.sourceData=this.makeArray(source);if($.isArray(this.sourceData)){this.doPrepend();success.call(this)}else{error.call(this)}}},doPrepend:function(){if(this.options.prepend===null||this.options.prepend===undefined){return}if(!$.isArray(this.prependData)){if($.isFunction(this.options.prepend)){this.options.prepend=this.options.prepend.call(this.options.scope)}this.options.prepend=$.fn.editableutils.tryParseJson(this.options.prepend,true);if(typeof this.options.prepend==="string"){this.options.prepend={"":this.options.prepend}}this.prependData=this.makeArray(this.options.prepend)}if($.isArray(this.prependData)&&$.isArray(this.sourceData)){this.sourceData=this.prependData.concat(this.sourceData)}},renderList:function(){},value2htmlFinal:function(value,element){},makeArray:function(data){var count,obj,result=[],item,iterateItem;if(!data||typeof data==="string"){return null}if($.isArray(data)){iterateItem=function(k,v){obj={value:k,text:v};if(count++>=2){return false}};for(var i=0;i<data.length;i++){item=data[i];if(typeof item==="object"){count=0;$.each(item,iterateItem);if(count===1){result.push(obj)}else if(count>1){if(item.children){item.children=this.makeArray(item.children)}result.push(item)}}else{result.push({value:item,text:item})}}}else{$.each(data,function(k,v){result.push({value:k,text:v})})}return result},option:function(key,value){this.options[key]=value;if(key==="source"){this.sourceData=null}if(key==="prepend"){this.prependData=null}}});List.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{source:null,prepend:false,sourceError:"Error when loading list",sourceCache:true,sourceOptions:null});$.fn.editabletypes.list=List})(window.jQuery);(function($){"use strict";var Text=function(options){this.init("text",options,Text.defaults)};$.fn.editableutils.inherit(Text,$.fn.editabletypes.abstractinput);$.extend(Text.prototype,{render:function(){this.renderClear();this.setClass();this.setAttr("placeholder")},activate:function(){if(this.$input.is(":visible")){this.$input.focus();$.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length);if(this.toggleClear){this.toggleClear()}}},renderClear:function(){if(this.options.clear){this.$clear=$('<span class="editable-clear-x"></span>');this.$input.after(this.$clear).css("padding-right",24).keyup($.proxy(function(e){if(~$.inArray(e.keyCode,[40,38,9,13,27])){return}clearTimeout(this.t);var that=this;this.t=setTimeout(function(){that.toggleClear(e)},100)},this)).parent().css("position","relative");this.$clear.click($.proxy(this.clear,this))}},postrender:function(){},toggleClear:function(e){if(!this.$clear){return}var len=this.$input.val().length,visible=this.$clear.is(":visible");if(len&&!visible){this.$clear.show()}if(!len&&visible){this.$clear.hide()}},clear:function(){this.$clear.hide();this.$input.val("").focus()}});Text.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:true});$.fn.editabletypes.text=Text})(window.jQuery);(function($){"use strict";var Textarea=function(options){this.init("textarea",options,Textarea.defaults)};$.fn.editableutils.inherit(Textarea,$.fn.editabletypes.abstractinput);$.extend(Textarea.prototype,{render:function(){this.setClass();this.setAttr("placeholder");this.setAttr("rows");this.$input.keydown(function(e){if(e.ctrlKey&&e.which===13){$(this).closest("form").submit()}})},activate:function(){$.fn.editabletypes.text.prototype.activate.call(this)
}});Textarea.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7});$.fn.editabletypes.textarea=Textarea})(window.jQuery);(function($){"use strict";var Select=function(options){this.init("select",options,Select.defaults)};$.fn.editableutils.inherit(Select,$.fn.editabletypes.list);$.extend(Select.prototype,{renderList:function(){this.$input.empty();var fillItems=function($el,data){var attr;if($.isArray(data)){for(var i=0;i<data.length;i++){attr={};if(data[i].children){attr.label=data[i].text;$el.append(fillItems($("<optgroup>",attr),data[i].children))}else{attr.value=data[i].value;if(data[i].disabled){attr.disabled=true}$el.append($("<option>",attr).text(data[i].text))}}}return $el};fillItems(this.$input,this.sourceData);this.setClass();this.$input.on("keydown.editable",function(e){if(e.which===13){$(this).closest("form").submit()}})},value2htmlFinal:function(value,element){var text="",items=$.fn.editableutils.itemsByValue(value,this.sourceData);if(items.length){text=items[0].text}$.fn.editabletypes.abstractinput.prototype.value2html.call(this,text,element)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){$(this).closest("form").submit()})}});Select.defaults=$.extend({},$.fn.editabletypes.list.defaults,{tpl:"<select></select>"});$.fn.editabletypes.select=Select})(window.jQuery);(function($){"use strict";var Checklist=function(options){this.init("checklist",options,Checklist.defaults)};$.fn.editableutils.inherit(Checklist,$.fn.editabletypes.list);$.extend(Checklist.prototype,{renderList:function(){var $label,$div;this.$tpl.empty();if(!$.isArray(this.sourceData)){return}for(var i=0;i<this.sourceData.length;i++){$label=$("<label>").append($("<input>",{type:"checkbox",value:this.sourceData[i].value})).append($("<span>").text(" "+this.sourceData[i].text));$("<div>").append($label).appendTo(this.$tpl)}this.$input=this.$tpl.find('input[type="checkbox"]');this.setClass()},value2str:function(value){return $.isArray(value)?value.sort().join($.trim(this.options.separator)):""},str2value:function(str){var reg,value=null;if(typeof str==="string"&&str.length){reg=new RegExp("\\s*"+$.trim(this.options.separator)+"\\s*");value=str.split(reg)}else if($.isArray(str)){value=str}else{value=[str]}return value},value2input:function(value){this.$input.prop("checked",false);if($.isArray(value)&&value.length){this.$input.each(function(i,el){var $el=$(el);$.each(value,function(j,val){if($el.val()==val){$el.prop("checked",true)}})})}},input2value:function(){var checked=[];this.$input.filter(":checked").each(function(i,el){checked.push($(el).val())});return checked},value2htmlFinal:function(value,element){var html=[],checked=$.fn.editableutils.itemsByValue(value,this.sourceData),escape=this.options.escape;if(checked.length){$.each(checked,function(i,v){var text=escape?$.fn.editableutils.escape(v.text):v.text;html.push(text)});$(element).html(html.join("<br>"))}else{$(element).empty()}},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(e){if(e.which===13){$(this).closest("form").submit()}})}});Checklist.defaults=$.extend({},$.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","});$.fn.editabletypes.checklist=Checklist})(window.jQuery);(function($){"use strict";var Password=function(options){this.init("password",options,Password.defaults)};$.fn.editableutils.inherit(Password,$.fn.editabletypes.text);$.extend(Password.prototype,{value2html:function(value,element){if(value){$(element).text("[hidden]")}else{$(element).empty()}},html2value:function(html){return null}});Password.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="password">'});$.fn.editabletypes.password=Password})(window.jQuery);(function($){"use strict";var Email=function(options){this.init("email",options,Email.defaults)};$.fn.editableutils.inherit(Email,$.fn.editabletypes.text);Email.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="email">'});$.fn.editabletypes.email=Email})(window.jQuery);(function($){"use strict";var Url=function(options){this.init("url",options,Url.defaults)};$.fn.editableutils.inherit(Url,$.fn.editabletypes.text);Url.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="url">'});$.fn.editabletypes.url=Url})(window.jQuery);(function($){"use strict";var Tel=function(options){this.init("tel",options,Tel.defaults)};$.fn.editableutils.inherit(Tel,$.fn.editabletypes.text);Tel.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'});$.fn.editabletypes.tel=Tel})(window.jQuery);(function($){"use strict";var NumberInput=function(options){this.init("number",options,NumberInput.defaults)};$.fn.editableutils.inherit(NumberInput,$.fn.editabletypes.text);$.extend(NumberInput.prototype,{render:function(){NumberInput.superclass.render.call(this);this.setAttr("min");this.setAttr("max");this.setAttr("step")},postrender:function(){if(this.$clear){this.$clear.css({right:24})}}});NumberInput.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null});$.fn.editabletypes.number=NumberInput})(window.jQuery);(function($){"use strict";var Range=function(options){this.init("range",options,Range.defaults)};$.fn.editableutils.inherit(Range,$.fn.editabletypes.number);$.extend(Range.prototype,{render:function(){this.$input=this.$tpl.filter("input");this.setClass();this.setAttr("min");this.setAttr("max");this.setAttr("step");this.$input.on("input",function(){$(this).siblings("output").text($(this).val())})},activate:function(){this.$input.focus()}});Range.defaults=$.extend({},$.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"});$.fn.editabletypes.range=Range})(window.jQuery);(function($){"use strict";var Time=function(options){this.init("time",options,Time.defaults)};$.fn.editableutils.inherit(Time,$.fn.editabletypes.abstractinput);$.extend(Time.prototype,{render:function(){this.setClass()}});Time.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'});$.fn.editabletypes.time=Time})(window.jQuery);(function($){"use strict";var Constructor=function(options){this.init("select2",options,Constructor.defaults);options.select2=options.select2||{};this.sourceData=null;if(options.placeholder){options.select2.placeholder=options.placeholder}if(!options.select2.tags&&options.source){var source=options.source;if($.isFunction(options.source)){source=options.source.call(options.scope)}if(typeof source==="string"){options.select2.ajax=options.select2.ajax||{};if(!options.select2.ajax.data){options.select2.ajax.data=function(term){return{query:term}}}if(!options.select2.ajax.results){options.select2.ajax.results=function(data){return{results:data}}}options.select2.ajax.url=source}else{this.sourceData=this.convertSource(source);options.select2.data=this.sourceData}}this.options.select2=$.extend({},Constructor.defaults.select2,options.select2);this.isMultiple=this.options.select2.tags||this.options.select2.multiple;this.isRemote="ajax"in this.options.select2;this.idFunc=this.options.select2.id;if(typeof this.idFunc!=="function"){var idKey=this.idFunc||"id";this.idFunc=function(e){return e[idKey]}}this.formatSelection=this.options.select2.formatSelection;if(typeof this.formatSelection!=="function"){this.formatSelection=function(e){return e.text}}};$.fn.editableutils.inherit(Constructor,$.fn.editabletypes.abstractinput);$.extend(Constructor.prototype,{render:function(){this.setClass();if(this.isRemote){this.$input.on("select2-loaded",$.proxy(function(e){this.sourceData=e.items.results},this))}if(this.isMultiple){this.$input.on("change",function(){$(this).closest("form").parent().triggerHandler("resize")})}},value2html:function(value,element){var text="",data,that=this;if(this.options.select2.tags){data=value}else if(this.sourceData){data=$.fn.editableutils.itemsByValue(value,this.sourceData,this.idFunc)}else{}if($.isArray(data)){text=[];$.each(data,function(k,v){text.push(v&&typeof v==="object"?that.formatSelection(v):v)})}else if(data){text=that.formatSelection(data)}text=$.isArray(text)?text.join(this.options.viewseparator):text;Constructor.superclass.value2html.call(this,text,element)},html2value:function(html){return this.options.select2.tags?this.str2value(html,this.options.viewseparator):null},value2input:function(value){if($.isArray(value)){value=value.join(this.getSeparator())}if(!this.$input.data("select2")){this.$input.val(value);this.$input.select2(this.options.select2)}else{this.$input.val(value).trigger("change",true)}if(this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var customId=this.options.select2.id,customText=this.options.select2.formatSelection;if(!customId&&!customText){var $el=$(this.options.scope);if(!$el.data("editable").isEmpty){var data={id:value,text:$el.text()};this.$input.select2("data",data)}}}},input2value:function(){return this.$input.select2("val")},str2value:function(str,separator){if(typeof str!=="string"||!this.isMultiple){return str}separator=separator||this.getSeparator();var val,i,l;if(str===null||str.length<1){return null}val=str.split(separator);for(i=0,l=val.length;i<l;i=i+1){val[i]=$.trim(val[i])}return val},autosubmit:function(){this.$input.on("change",function(e,isInitial){if(!isInitial){$(this).closest("form").submit()}})},getSeparator:function(){return this.options.select2.separator||$.fn.select2.defaults.separator},convertSource:function(source){if($.isArray(source)&&source.length&&source[0].value!==undefined){for(var i=0;i<source.length;i++){if(source[i].value!==undefined){source[i].id=source[i].value;delete source[i].value}}}return source},destroy:function(){if(this.$input.data("select2")){this.$input.select2("destroy")}}});Constructor.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "});$.fn.editabletypes.select2=Constructor})(window.jQuery);(function($){var Combodate=function(element,options){this.$element=$(element);if(!this.$element.is("input")){$.error("Combodate should be applied to INPUT element");return}this.options=$.extend({},$.fn.combodate.defaults,options,this.$element.data());this.init()};Combodate.prototype={constructor:Combodate,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]};this.$widget=$('<span class="combodate"></span>').html(this.getTemplate());this.initCombos();this.$widget.on("change","select",$.proxy(function(e){this.$element.val(this.getValue()).change();if(this.options.smartDays){if($(e.target).is(".month")||$(e.target).is(".year")){this.fillCombo("day")}}},this));this.$widget.find("select").css("width","auto");this.$element.hide().after(this.$widget);this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var tpl=this.options.template;$.each(this.map,function(k,v){v=v[0];var r=new RegExp(v+"+"),token=v.length>1?v.substring(1,2):v;tpl=tpl.replace(r,"{"+token+"}")});tpl=tpl.replace(/ /g,"&nbsp;");$.each(this.map,function(k,v){v=v[0];var token=v.length>1?v.substring(1,2):v;tpl=tpl.replace("{"+token+"}",'<select class="'+k+'"></select>')});return tpl},initCombos:function(){for(var k in this.map){var $c=this.$widget.find("."+k);this["$"+k]=$c.length?$c:null;this.fillCombo(k)}},fillCombo:function(k){var $combo=this["$"+k];if(!$combo){return}var f="fill"+k.charAt(0).toUpperCase()+k.slice(1);var items=this[f]();var value=$combo.val();$combo.empty();for(var i=0;i<items.length;i++){$combo.append('<option value="'+items[i][0]+'">'+items[i][1]+"</option>")}$combo.val(value)},fillCommon:function(key){var values=[],relTime;if(this.options.firstItem==="name"){relTime=moment.relativeTime||moment.langData()._relativeTime;var header=typeof relTime[key]==="function"?relTime[key](1,true,key,false):relTime[key];header=header.split(" ").reverse()[0];values.push(["",header])}else if(this.options.firstItem==="empty"){values.push(["",""])}return values},fillDay:function(){var items=this.fillCommon("d"),name,i,twoDigit=this.options.template.indexOf("DD")!==-1,daysCount=31;if(this.options.smartDays&&this.$month&&this.$year){var month=parseInt(this.$month.val(),10);var year=parseInt(this.$year.val(),10);if(!isNaN(month)&&!isNaN(year)){daysCount=moment([year,month]).daysInMonth()}}for(i=1;i<=daysCount;i++){name=twoDigit?this.leadZero(i):i;items.push([i,name])}return items},fillMonth:function(){var items=this.fillCommon("M"),name,i,longNames=this.options.template.indexOf("MMMM")!==-1,shortNames=this.options.template.indexOf("MMM")!==-1,twoDigit=this.options.template.indexOf("MM")!==-1;for(i=0;i<=11;i++){if(longNames){name=moment().date(1).month(i).format("MMMM")}else if(shortNames){name=moment().date(1).month(i).format("MMM")}else if(twoDigit){name=this.leadZero(i+1)}else{name=i+1}items.push([i,name])}return items},fillYear:function(){var items=[],name,i,longNames=this.options.template.indexOf("YYYY")!==-1;for(i=this.options.maxYear;i>=this.options.minYear;i--){name=longNames?i:(i+"").substring(2);items[this.options.yearDescending?"push":"unshift"]([i,name])}items=this.fillCommon("y").concat(items);return items},fillHour:function(){var items=this.fillCommon("h"),name,i,h12=this.options.template.indexOf("h")!==-1,h24=this.options.template.indexOf("H")!==-1,twoDigit=this.options.template.toLowerCase().indexOf("hh")!==-1,min=h12?1:0,max=h12?12:23;for(i=min;i<=max;i++){name=twoDigit?this.leadZero(i):i;items.push([i,name])}return items},fillMinute:function(){var items=this.fillCommon("m"),name,i,twoDigit=this.options.template.indexOf("mm")!==-1;for(i=0;i<=59;i+=this.options.minuteStep){name=twoDigit?this.leadZero(i):i;items.push([i,name])}return items},fillSecond:function(){var items=this.fillCommon("s"),name,i,twoDigit=this.options.template.indexOf("ss")!==-1;for(i=0;i<=59;i+=this.options.secondStep){name=twoDigit?this.leadZero(i):i;items.push([i,name])}return items},fillAmpm:function(){var ampmL=this.options.template.indexOf("a")!==-1,ampmU=this.options.template.indexOf("A")!==-1,items=[["am",ampmL?"am":"AM"],["pm",ampmL?"pm":"PM"]];return items},getValue:function(format){var dt,values={},that=this,notSelected=false;$.each(this.map,function(k,v){if(k==="ampm"){return}var def=k==="day"?1:0;values[k]=that["$"+k]?parseInt(that["$"+k].val(),10):def;if(isNaN(values[k])){notSelected=true;return false}});if(notSelected){return""}if(this.$ampm){if(values.hour===12){values.hour=this.$ampm.val()==="am"?0:12}else{values.hour=this.$ampm.val()==="am"?values.hour:values.hour+12}}dt=moment([values.year,values.month,values.day,values.hour,values.minute,values.second]);this.highlight(dt);format=format===undefined?this.options.format:format;if(format===null){return dt.isValid()?dt:null}else{return dt.isValid()?dt.format(format):""}},setValue:function(value){if(!value){return}var dt=typeof value==="string"?moment(value,this.options.format):moment(value),that=this,values={};function getNearest($select,value){var delta={};$select.children("option").each(function(i,opt){var optValue=$(opt).attr("value"),distance;if(optValue==="")return;distance=Math.abs(optValue-value);if(typeof delta.distance==="undefined"||distance<delta.distance){delta={value:optValue,distance:distance}}});return delta.value}if(dt.isValid()){$.each(this.map,function(k,v){if(k==="ampm"){return}values[k]=dt[v[1]]()});if(this.$ampm){if(values.hour>=12){values.ampm="pm";if(values.hour>12){values.hour-=12}}else{values.ampm="am";if(values.hour===0){values.hour=12}}}$.each(values,function(k,v){if(that["$"+k]){if(k==="minute"&&that.options.minuteStep>1&&that.options.roundTime){v=getNearest(that["$"+k],v)}if(k==="second"&&that.options.secondStep>1&&that.options.roundTime){v=getNearest(that["$"+k],v)}that["$"+k].val(v)}});if(this.options.smartDays){this.fillCombo("day")}this.$element.val(dt.format(this.options.format)).change()}},highlight:function(dt){if(!dt.isValid()){if(this.options.errorClass){this.$widget.addClass(this.options.errorClass)}else{if(!this.borderColor){this.borderColor=this.$widget.find("select").css("border-color")}this.$widget.find("select").css("border-color","red")}}else{if(this.options.errorClass){this.$widget.removeClass(this.options.errorClass)}else{this.$widget.find("select").css("border-color",this.borderColor)}}},leadZero:function(v){return v<=9?"0"+v:v},destroy:function(){this.$widget.remove();this.$element.removeData("combodate").show()}};$.fn.combodate=function(option){var d,args=Array.apply(null,arguments);args.shift();if(option==="getValue"&&this.length&&(d=this.eq(0).data("combodate"))){return d.getValue.apply(d,args)}return this.each(function(){var $this=$(this),data=$this.data("combodate"),options=typeof option=="object"&&option;if(!data){$this.data("combodate",data=new Combodate(this,options))}if(typeof option=="string"&&typeof data[option]=="function"){data[option].apply(data,args)}})};$.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,yearDescending:true,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:true,smartDays:false}})(window.jQuery);(function($){"use strict";var Constructor=function(options){this.init("combodate",options,Constructor.defaults);if(!this.options.viewformat){this.options.viewformat=this.options.format}options.combodate=$.fn.editableutils.tryParseJson(options.combodate,true);this.options.combodate=$.extend({},Constructor.defaults.combodate,options.combodate,{format:this.options.format,template:this.options.template})};$.fn.editableutils.inherit(Constructor,$.fn.editabletypes.abstractinput);$.extend(Constructor.prototype,{render:function(){this.$input.combodate(this.options.combodate);if($.fn.editableform.engine==="bs3"){this.$input.siblings().find("select").addClass("form-control")}if(this.options.inputclass){this.$input.siblings().find("select").addClass(this.options.inputclass)}},value2html:function(value,element){var text=value?value.format(this.options.viewformat):"";Constructor.superclass.value2html.call(this,text,element)},html2value:function(html){return html?moment(html,this.options.viewformat):null},value2str:function(value){return value?value.format(this.options.format):""},str2value:function(str){return str?moment(str,this.options.format):null},value2submit:function(value){return this.value2str(value)},value2input:function(value){this.$input.combodate("setValue",value)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}});Constructor.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null});$.fn.editabletypes.combodate=Constructor})(window.jQuery);(function($){"use strict";$.extend($.fn.editableContainer.Popup.prototype,{containerName:"poshytip",innerCss:"div.tip-inner",defaults:$.fn.poshytip?$.fn.poshytip.defaults:null,initContainer:function(){this.handlePlacement();$.extend(this.containerOptions,{showOn:"none",content:"",alignTo:"target"});this.call(this.containerOptions)},show:function(closeAll){this.$element.addClass("editable-open");if(closeAll!==false){this.closeOthers(this.$element[0])}this.$form=$("<div>");this.renderForm();var $label=$("<label>").text(this.options.title||this.$element.data("title")||this.$element.data("originalTitle")),$content=$("<div>").append($label).append(this.$form);this.call("update",$content);this.call("show");this.tip().addClass(this.containerClass);this.$form.data("editableform").input.activate()},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setPosition:function(){this.container().refresh(false)},handlePlacement:function(){var x,y,ox=0,oy=0;switch(this.options.placement){case"top":x="center";y="top";oy=5;break;case"right":x="right";y="center";ox=10;break;case"bottom":x="center";y="bottom";oy=5;break;case"left":x="left";y="center";ox=10;break}$.extend(this.containerOptions,{alignX:x,offsetX:ox,alignY:y,offsetY:oy})}});$.fn.editableContainer.defaults=$.extend({},$.fn.editableContainer.defaults,{className:"tip-yellowsimple"});if($.Poshytip){var tips=[],reBgImage=/^url\(["']?([^"'\)]*)["']?\);?$/i,rePNG=/\.png$/i,ie6=!!window.createPopup&&document.documentElement.currentStyle.minWidth=="undefined";$.Poshytip.prototype.refresh=function(async){if(this.disabled)return;var currPos;if(async){if(!this.$tip.data("active"))return;currPos={left:this.$tip.css("left"),top:this.$tip.css("top")}}this.$tip.css({left:0,top:0}).appendTo(document.body);if(this.opacity===undefined)this.opacity=this.$tip.css("opacity");var bgImage=this.$tip.css("background-image").match(reBgImage),arrow=this.$arrow.css("background-image").match(reBgImage);if(bgImage){var bgImagePNG=rePNG.test(bgImage[1]);if(ie6&&bgImagePNG){this.$tip.css("background-image","none");this.$inner.css({margin:0,border:0,padding:0});bgImage=bgImagePNG=false}else{this.$tip.prepend('<table class="fallback" border="0" cellpadding="0" cellspacing="0"><tr><td class="tip-top tip-bg-image" colspan="2"><span></span></td><td class="tip-right tip-bg-image" rowspan="2"><span></span></td></tr><tr><td class="tip-left tip-bg-image" rowspan="2"><span></span></td><td></td></tr><tr><td class="tip-bottom tip-bg-image" colspan="2"><span></span></td></tr></table>').css({border:0,padding:0,"background-image":"none","background-color":"transparent"}).find(".tip-bg-image").css("background-image",'url("'+bgImage[1]+'")').end().find("td").eq(3).append(this.$inner)}if(bgImagePNG&&!$.support.opacity)this.opts.fade=false}if(arrow&&!$.support.opacity){if(ie6&&rePNG.test(arrow[1])){arrow=false;this.$arrow.css("background-image","none")}this.opts.fade=false}var $table=this.$tip.find("table.fallback");if(ie6){this.$tip[0].style.width="";$table.width("auto").find("td").eq(3).width("auto");var tipW=this.$tip.width(),minW=parseInt(this.$tip.css("min-width"),10),maxW=parseInt(this.$tip.css("max-width"),10);if(!isNaN(minW)&&tipW<minW)tipW=minW;else if(!isNaN(maxW)&&tipW>maxW)tipW=maxW;this.$tip.add($table).width(tipW).eq(0).find("td").eq(3).width("100%")}else if($table[0]){$table.width("auto").find("td").eq(3).width("auto").end().end().width(document.defaultView&&document.defaultView.getComputedStyle&&parseFloat(document.defaultView.getComputedStyle(this.$tip[0],null).width)||this.$tip.width()).find("td").eq(3).width("100%")}this.tipOuterW=this.$tip.outerWidth();this.tipOuterH=this.$tip.outerHeight();this.calcPos();if(arrow&&this.pos.arrow){this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow;this.$arrow.css("visibility","inherit")}if(async){this.asyncAnimating=true;var self=this;this.$tip.css(currPos).animate({left:this.pos.l,top:this.pos.t},200,function(){self.asyncAnimating=false})}else{this.$tip.css({left:this.pos.l,top:this.pos.t})}}}})(window.jQuery);(function($){"use strict";var DateUI=function(options){this.init("dateui",options,DateUI.defaults);this.initPicker(options,DateUI.defaults)};$.fn.editableutils.inherit(DateUI,$.fn.editabletypes.abstractinput);$.extend(DateUI.prototype,{initPicker:function(options,defaults){if(!this.options.viewformat){this.options.viewformat=this.options.format}this.options.viewformat=this.options.viewformat.replace("yyyy","yy");this.options.format=this.options.format.replace("yyyy","yy");this.options.datepicker=$.extend({},defaults.datepicker,options.datepicker,{dateFormat:this.options.viewformat})},render:function(){this.$input.datepicker(this.options.datepicker);if(this.options.clear){this.$clear=$('<a href="#"></a>').html(this.options.clear).click($.proxy(function(e){e.preventDefault();e.stopPropagation();this.clear()},this));this.$tpl.parent().append($('<div class="editable-clear">').append(this.$clear))}},value2html:function(value,element){var text=$.datepicker.formatDate(this.options.viewformat,value);DateUI.superclass.value2html.call(this,text,element)},html2value:function(html){if(typeof html!=="string"){return html}var d;try{d=$.datepicker.parseDate(this.options.viewformat,html)}catch(e){}return d},value2str:function(value){return $.datepicker.formatDate(this.options.format,value)},str2value:function(str){if(typeof str!=="string"){return str}var d;try{d=$.datepicker.parseDate(this.options.format,str)}catch(e){}return d},value2submit:function(value){return this.value2str(value)},value2input:function(value){this.$input.datepicker("setDate",value)},input2value:function(){return this.$input.datepicker("getDate")},activate:function(){},clear:function(){this.$input.datepicker("setDate",null);if(this.isAutosubmit){this.submit()}},autosubmit:function(){this.isAutosubmit=true;this.$input.on("mouseup","table.ui-datepicker-calendar a.ui-state-default",$.proxy(this.submit,this))},submit:function(){var $form=this.$input.closest("form");setTimeout(function(){$form.submit()},200)}});DateUI.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{firstDay:0,changeYear:true,changeMonth:true,showOtherMonths:true},clear:"&times; clear"});$.fn.editabletypes.dateui=DateUI})(window.jQuery);(function($){"use strict";var DateUIField=function(options){this.init("dateuifield",options,DateUIField.defaults);this.initPicker(options,DateUIField.defaults)};$.fn.editableutils.inherit(DateUIField,$.fn.editabletypes.dateui);$.extend(DateUIField.prototype,{render:function(){this.$input.datepicker(this.options.datepicker);$.fn.editabletypes.text.prototype.renderClear.call(this)},value2input:function(value){this.$input.val($.datepicker.formatDate(this.options.viewformat,value))},input2value:function(){return this.html2value(this.$input.val())},activate:function(){$.fn.editabletypes.text.prototype.activate.call(this)},toggleClear:function(){$.fn.editabletypes.text.prototype.toggleClear.call(this)},autosubmit:function(){}});DateUIField.defaults=$.extend({},$.fn.editabletypes.dateui.defaults,{tpl:'<input type="text"/>',inputclass:null,datepicker:{showOn:"button",buttonImage:"http://jqueryui.com/resources/demos/datepicker/images/calendar.gif",buttonImageOnly:true,firstDay:0,changeYear:true,changeMonth:true,showOtherMonths:true},clear:false});$.fn.editabletypes.dateuifield=DateUIField})(window.jQuery);